<!-- Scroll animations -->
<script>
  const initializeObserver = () => {
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("scroll-animated");
        }
      });
    });

    const elements = document.querySelectorAll(
      ".scroll-animation [data-scroll-animate]"
    );

    elements.forEach((element) => {
      observer.observe(element);
    });
  };

  document.addEventListener("DOMContentLoaded", () => {
    initializeObserver();
  });

  document.addEventListener("astro:page-loaded", () => {
    initializeObserver();
  });

  document.addEventListener("astro:after-swap", () => {
    initializeObserver();
  });

  //currency update
  import { configStore } from "@/stores/config";

  function updateConfigDetails(config) {
    const currencyElem = document.querySelectorAll(".currency-symbol");

    if (config.currencySymbol && currencyElem.length) {
      currencyElem.forEach((el) => {
        // Assuming config.currency contains the icon's HTML (e.g., SVG or <img>)
        el.innerHTML = config.currencySymbol;
      });
    }
    // if (config.lang && langElem.length) {
    //   langElem.forEach((el) => (el.textContent = config.lang));
    // }
  }

  //Listen changes
  configStore.subscribe(() => {
    updateConfigDetails(configStore.get());
  });

  // Run once after Astro page rendered
  if (typeof window !== "undefined") {
    document.addEventListener("astro:page-load", () => {
      updateConfigDetails(configStore.get());
    });
  }
</script>
